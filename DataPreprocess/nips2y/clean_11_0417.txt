abstract examin problem estim paramet multinomi distribut larg number discret outcom appear train data analyz problem bayesian perspect develop hierarch prior incorpor assumpt observ outcom constitut small subset possibl outcom show effici perform exact infer form hierarch prior compar standard approach introduct one import problem statist infer multinomialestim given past histori observ independ trial discret set outcom predict probabl next trial estim basic build block complex statist model predict tree hidden markov model bayesian network root multinomi estim go back laplac work th centuri bayesian theori classic approach multinomi estim via use dirichlet distribut see instanc laplac law success common method deriv use bayesian infer dirichlet distribut prior distribut dirichlet distribut sever properti use statist infer particular estim dirichlet prior consist estim converg probabl one true distribut conjug posterior distribut also dirichlet distribut comput effici queri interest close form solut furthermor theoret studi onlin predict individu sequenc show predict use dirichlet prior competit prior distribut see instanc refer therein unfortun key applic dirichlet prior unwieldi applic character sever featur set possibl outcom extrem larg often known advanc number train exampl small compar friedman singer number possibl outcom outcom posit probabl constitut rel small subset possibl outcom subset howev known advanc situat predict base dirichlet prior tend assign probabl mass outcom seen train set exampl consid natur languag applic outcom word drawn english dictionari problem predict probabl word follow particular word say bosnia prior knowledg consid word dictionari possibl candid yet knowledg languag would lead us believ fact word herzegovina natur follow word bosnia furthermor even larg corpu expect see mani train exampl involv phrase anoth exampl consid problem estim paramet discret dynam system task find distribut state reach particular state possibl system receiv extern control signal mani domain natur assum system spars small subset state reachabl state paper present bayesian treatment problem use hierarch prior averag exponenti number hypothes repres subset feasibl outcom prior previous use specif context onlin predict use suffix tree transduc show although prior involv exponenti mani hypothes effici perform predict moreov approach allow us deal countabl infinit number outcom dirichlet prior let random variabl take possibl valu set without loss gener let given train set contain outcom independ draw ate unknown multinomi distribut denot ni number occurr symbol train data multinomi estim problem find good approxim problem state problem predict outcom given atn given prior distribut possibl multinomi distribut bayesian estim xn vector describ possibl valu unknown probabl context variabl denot assumpt domain consid particular context next section posterior probabl rewritten use bay law xl ii famili dirichlet distribut conjug multinomi distribut prior distribut famili posterior dirichlet prior specifi hyperparamet az form ho oi andoi ofor yii oq fo le tdt gamma function given dirichlet prior initi predict valu foip ol effici bayesian paramet estim larg discret domain easi see prior dirichlet prior hyperparamet ct al posterior dirichlet hyperparamet ct thu get predict zn ai ni aj nj think hyperparamet number imaginari exampl saw outcom thu ratio hyperparamet correspond initi assess rel probabl correspond outcom total weight hyperparamet repres confid entrench prior knowledg see weight larg estim paramet tend empir frequenc observ train data hierarch prior describ structur prior captur uncertainti set feasibl valu defin random variabl take valu set possibl subset intend semant variabl oi iff clearli hypothesi consist train data contain indic ni denot set observ symbol ni let iz isuppos know valu given assumpt defin dirichlet prior possibl multinomi distribut use hyper paramet ct symbol formal defin prior oiv use eq ivl oi vi oi oi ivla lz ifi otherwis consid case uncertain actual set feasibl outcom construct two tier prior valu start prior size assum set cardin prior probabl let random variabl denot cardin assum given distribut defin prior set examin comput posterior predict given hierarch prior let denot train data easi verifi il ni ka lvl let us examin set actual contribut sum first note set contain zero posterior probabl sinc inconsist observ data thu examin set contain second note set cardin contain moreov definit prior set use bay rule conclud set size contain thu friedman singer simplifi inner summat eq multipli number set score summat posterior probabl set two case set non zero posterior probabl appear sum thu case write ni kid ka need estim fraction subset non zero posterior contain lead equat similar one correct fraction symmetri unobserv outcom posterior probabl thu simpli divid mass assign observ outcom among unseen symbol notic singl term eq depend ni move outsid summat thu make predict need estim quantiti ne ek ka jvc ificz therefor think scale factor appli dirichlet predict assum seen feasibl symbol quantiti probabl mass assign novel unseen outcom use properti dirichlet prior get follow character mk proposit kid rn proof comput need comput use bay rule introduct variabl ro lvl use standard properti difichlet prior zo olw iwl use eq get ifz ivi ni thu oi effici bayesian paramet estim larg discret domain figur left illustr posterior distribut differ valu oc right illustr show chang differ valu oc term squar bracket depend choic thu cancel plug eq eq desir equal follow directli proposit immedi get kc rn kt rn note depend depend distribut count among observ symbol also note suffici larger depend choic term much smaller impli posterior larger set decay rapidli see behavior left hand side figur show posterior distribut differ dataset size unbound alphabet examin analyt form see depend express number term summat term rn vanish larg becom insensit exact size alphabet see behavior right hand side figur show function see close le close grow asymptot valu depend well prior discuss suggest appli prior case know advanc fact assum unbound isomorph assum assign prior choic lim exist defin oc lim use predict term koo method work ensur oo well defin limit exist two case identifi follow proposit proof omit proposit exponenti decreas polynomi decreas oo well defin practic evalu oo comput success valu logarithm rn reach valu significantli smaller largest valu beforehand friedman singer method approxim good ture spars multinomi poli spars multinomi exp perplex observ novel overal tabl perplex result heterogen charact data sinc rn exponenti decay ignor mass tail sequenc see right hand side figur much differ predict use larg unbound one empir evalu use propos estim method construct statist model predict probabl charact context previous observ charact model often refer bigram model great interest applic optic charact recognit text compress test two prior distribut alphabet size po exponenti prior po polynomi prior po train test materi deriv variou archiv includ differ type file program core dump ascii text file alphabet algorithm consist ascii non ascii possibl charact train data consist around mega byte test use mega byte model compar assign probabl charact charact observ context previou charact new charact assign probabl total mass novel event compar approach two estim techniqu shown perform well natur data set first estim probabl symbol context given word number differ charact observ given context previou charact second method base approxim good ture estim scheme estim probabl symbol number differ charact observ given context detail see evalu use perplex simpli exponenti averag log loss test data tabl summar averag test set perplex observ charact novel event overal perplex experi fix ct paramet dirichlet prior exponenti polynomi decay prior alphabet size one see tabl predict use spars multinomi achiev lowest overal perplex differ statist signific due size data perform base two differ prior alphabet size compar result indic leverag use spars multinomi predict due accur predict observ event inde perplex novel event use spars multinomi much higher use either method put anoth way approach prefer sacrific event low probabl novel event suffer high loss favor accur predict frequent occur event net effect lower overal perplex effici bayesian paramet estim larg discret domain discuss paper present bayesian approach problem estim paramet multinomi sourc larg alphabet method base hierarch prior clearli identifi assumpt made prior given assumpt predict reduc probabilist infer main result show perform infer exactli effici manner among numer techniqu use multinomi estim one propos ristad closest though methodolog use ristad substanti differ method seen special case spars multinomi ct set specif prior alphabet size main advantag choic simpler infer procedur simplic come price lose flexibl addit method explicitli repres posterior distribut henc suitabl task stochast sampl explicit represent approxim distribut requir final method combin bayesian approach languag model one propos mackay peto bayesian approach learn complex model bayesian network acknowledg grate fernando pereira stuart russel discuss relat work work done nir friedman berkeley support aro grant number daah onr grant number refer buntin learn classif tree artifici intellig frontier statist chapman hall clark barron jeffrey prior asymptot least favor entrop risk stat plan infer cooper herskovit bayesian method induct probabilist network data machin learn degroot optim statist decis mcgraw hill good popul frequenc speci estim popul paramet biometrika heckerman geiger chicker learn bayesian network combin knowledg statist data machin learn laplac philosoph essay probabl springer verlag mackay peto hierarch dirichlet languag model natur languag eng rabin juang introduct hidden markov model ieee assp mag ristad natur law success tech report cs tr princeton univ singer adapt mixtur probabilist transduc neur comp willem shtarkov tjalken context tree weight method basic properti ieee tran info theori witten bell zero frequenc problem estim probabl novel event adapt text compress ieee tran info theori