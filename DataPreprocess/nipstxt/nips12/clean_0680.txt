abstract mani hierarch cluster algorithm avail lack firm statist basi set hierarch probabilist mixtur model data gener hierarch tree structur manner markov chain mont carlo mcmc method demonstr use sampl posterior distribut tree contain variabl number hidden unit introduct past decad two mixtur model becom popular approach cluster competit learn problem advantag well defin object function fit gener trend view neural network problem statist framework howev one disadvantag produc flat cluster structur rather hierarch tree structur return cluster algorithm agglom singl link method see paper formul hierarch mixtur model retain advantag statist framework also featur tree structur hierarchi basic idea illustr figur root tree level singl centr mark mean gaussian larg varianc repres larg circl random number centr case sampl level gaussian produc new centr mark varianc associ level gaussian smaller number level unit produc associ level gaussian centr level unit mark sampl parent gaussian hierarch process could continu indefinit exampl gener data level gaussian shown dot figur three level version model would standard mixtur model gaussian prior centr locat four level model third level centr clump togeth around second level mean distinguish model flat mixtur model anoth view gener process given figur tree structur denot node children particular parent note also direct acycl graph arrow denot depend posit child parent mcmc approach hierarch mixtur model section describ theori probabilist hierarch cluster give discuss relat work experiment result describ section figur basic idea hierarch mixtur model denot root tree second level centr denot third level centr data gener third level centr sampl random point gaussian whose mean third level centr correspond tree structur theori describ turn prior tree ii calcul likelihood given data vector iii markov chain mont carlo mcmc method infer tree structur given data iv relat work prior tree describ first prior number unit layer prior connect layer consid layer hierarch model root node level node level node level collect togeth vector use markovian model ln nllnl current taken poisson distribut offset rti irti po xini xi paramet associ level offset use must alway least one unit layer given next consid tree form tree structur describ node ith layer parent node th layer unit indic vector store index parent attach collect indic vector togeth matrix denot probabl node layer connect node layer taken rt thu ii describ gener random tree given simplic describ gener point although everyth extend arbitrari dimens easili mean level gaussian origin lit easi relax assumpt ttt prior gaussian distribut locat point origin william level mean tt gener tt cri cr varianc associ level node similarli posit level node gener level parent displac posit level parent displac gaussian rv zero mean varianc cr process continu visibl variabl order model use requir cr cr cr variabl introduc success level declin monoton cf scale wavelet coeffici calcul likelihood data observ posit point final layer denot calcul likelihood model need integr locat mean hidden variabl level done explicitli howev shorten calcul realiz given gener distribut observ gaussian covari matrix calcul follow consid two leaf node index gaussian rv gener posit two leav denot xk wk xt calcul covari xk xt simpli calcul xkxt depend crucial mani share node cf path analysi exampl node lie differ branch tree level covari zero varianc sum varianc rv tree covari xk xt determin find level tree common parent occur assumpt log likelihood given lxtc nl log log ic fact calcul speed take account tree structur see note also posterior mean varianc hidden variabl calcul base covari hidden visibl node calcul carri effici see pearl section detail infer given problem tri infer connect structur given observ cours interest posterior distribut zix one approach use markov chain mont carlo mcmc method sampl posterior distribut straightforward way use metropoli algorithm propos chang structur chang parent singl node time note similar algorithm work william adam dynam tree dt main differ disconnect allow maintain singl tree rather forest ii variabl dt imag model discret rather gaussian also need consid move chang effect split merg move split direct consid node parent sever children split node randomli assign children two split node split node keep parent probabl accept move metropoli hast scheme nt nt nt nt min lx mcmc approach hierarch mixtur model propos probabl configur given configur scheme base work mcmc model composit mg madigan york green work revers jump mcmc anoth move chang remov dangl node node children occur node given layer decid use one node layer altern sampl posterior use approxim infer mean field method current investig dt model relat work larg number paper hierarch cluster work focuss express hierarch cluster term probabilist model exampl ambro ingerson et al mozer develop model idea cluster data coars level subtract mean cluster residu recurs paper seen probabilist interpret idea reconstruct phylogenet tree biolog sequenc dna protein inform give rise problem infer binari tree data durbin et al chapter show probabilist formul problem develop link agglom hierarch cluster algorithm approxim full probabilist method see much biolog sequenc work use discret variabl diverg somewhat focu current work howev work edward concern branch brownian motion process similar model describ import differ edward model continu time varianc particl deriv wiener process varianc proport lifetim particl contrast decreas sequenc varianc given number level assum model one import differ model discuss paper phylogenet tree model point higher level phylogenet tree taken individu earlier time evolutionari histori interpret requir differ notion hierarchi mixtur model found work autoclass system describ model involv class hierarchi inherit tree specifi dimens share paramet occur mean covari matric gaussian contrast model paper creat hierarchi exampl label rather dimens xu pearl discuss infer tree structur belief network base knowledg covari leaf node algorithm cannot appli directli case covari known although note multipl run given tree structur avail covari might approxim use sampl estim idea concern hierarch cluster discuss experi describ two set experi explor idea search fix level random tree gener prior use valu cr cr cr tree leaf william node averag tree kept generaf tree sampl carri start random initi configur given node propos chang parent propos accept reject usual metropoli probabl one sweep node level make move level node one parent point move obtain repres sampl ln run chain long possibl howev also use chain find configur high posterior probabl case run longer increas chanc find better configur experi sampler run sweep uniform fix posterior simpli proport likelihood term would also possibl run simul anneal move set search explicitli maximum posteriori map configur result case tree highest posterior probabl hpp configur higher posterior probabl gener tree case tree found case hpp solut inferior gener tree fact almost case sampler found configur good better gener one rel small number sweep encourag figur gener left column hpp tree fix middl column plot two exampl panel note dangl node level mean level node left end inferior configur contrast panel sampler found better less tangl configur gener model figur show generaf tree two exampl correspond hpp tree fix plot variabl number panel log posterior probabl configur node level shown locat posterior mean appar non tree structur caus two node plot almost top search given data usual know appropri number hidden unit motiv search achiev use split merg move discuss section experi initi number unit level denot mcmc approach hierarch mixtur model set use simpl mind formula dim xal proper inferenti calcul carri requir solut non linear optim problem given initi connect configur chosen randomli search method use propos split merg move probabl level sampl level level connect propos split merg move level updat level level connect compris singl sweep sweep use experi conduct tree use section case result case hpp configur higher posterior probabl gener tree case tree found case hpp solut inferior gener tree overal result less good one section rememb search space much larger would expect one would need search longer compar result fix variabl show case variabl method gave higher posterior probabl case lower case tree found rightmost column figur show hpp configur sampl variabl two exampl discuss panel solut found dissimilar panel although overal probabl lower solut found use one level centr rather two obtain higher posterior probabl configur discuss result indic propos model behav sensibl reason solut found rel short amount search method demonstr univari data extend multivari gaussian data dimens independ given tree structur easi likelihood calcul independ dimens mani direct model develop firsfli model present uniform mix proport children equal like connect potenti parent gener non uniform vector connect probabl layer also given tree structur independ dirichlet prior probabl vector paramet integr analyt secondli model made gener iid data regard penultim layer mixtur centr case term lin would ignor comput probabl tree thirdli would possibl add varianc variabl mcmc scheme use metropoli algorithm defin suitabl prior sequenc varianc cri constraint varianc level equal could also relax allow depend hyperparamet set everi level fourthli may improv mcmc scheme devis exampl current implement posterior mean candid unit taken account propos merg move cf fifthli multivari gaussian version consid tree structur factor analysi model higher level tree need dimension data vector one also consid version dimens multinomi rather continu variabl case one might consid model multinomi paramet vector ot tree gener parent ot random vector probabl altern model could build tree lliam structur prior paramet dirichlet prior multinomi distribut acknowledg work partial support epsrc grant gr probabilist model sequenc thank gatsbi comput neurosci unit ucl organ mixtur day march support attend peter green phil dawid peter dayan help discuss meet also thank amo storkey help discuss magnu rattray accident point toward chapter phylogenet tree